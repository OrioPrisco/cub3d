/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   main.c                                             :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: OrioPrisco <47635210+OrioPrisco@users      +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2023/11/28 15:24:35 by OrioPrisc         #+#    #+#             */
/*   Updated: 2024/01/26 12:43:05 by OrioPrisc        ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "raycast.h"
#include "math_utils.h"
#include "libft.h"
#include "env.h"
#include "mlx.h"
#include "draw.h"
#include "hooks.h"
#include <X11/X.h>
#include "map.h"
#include <stdlib.h>

static char	*g_tab[] = {
/*
	"11111111111111111111111111111",
	"10000000000000000000000000001",
	"10000011000001100000010000001",
	"10000011000001100000010000001",
	"10000000000000000000010000001",
	"10000000000000000000010000001",
	"10000000000000000000010000001",
	"10000000000000000000010000001",
	"10000000000000000000000000001",
	"10000000000000000000000000001",
	"10000111111110000000000000001",
	"10000000000000000000000000001",
	"10000000000000000000000000001",
	"10000000000000000000000000001",
	"11111111111111111111111111111",
	*/
	/*
	"11111111111111111111",
	"1E000000000000000001",
	"11111111111111111101",
	"10000000000000000001",
	"1011111111111111111 ",
	"10000000000000000001",
	"11111111111111111101",
	"10000000000000000101",
	"10111111111111110101",
	"10100000000000000101",
	"10111111111111111101",
	"10000000000000000001",
	"1111111111111111111 ",
	*/
	"111",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"101",
	"1S1",
	"111",
	NULL
};

int	main(void)
{
	t_env		env;
	t_img		tmp;

	ft_bzero(&env, sizeof(env));
	init_env(&env);
	load_xpm(env.mlx, "textures/ball.xpm", &tmp);
	vector_append(&env.graphics.textures, &tmp);
	load_xpm(env.mlx, "textures/test.xpm", &tmp);
	vector_append(&env.graphics.textures, &tmp);
	load_xpm(env.mlx, "textures/brick_wall.xpm", &tmp);
	vector_append(&env.graphics.textures, &tmp);
	load_xpm(env.mlx, "textures/test.xpm", &tmp);
	vector_append(&env.graphics.textures, &tmp);
	if (map_to_lines(g_tab, &env.lines, &env.graphics.line_textures_id, (t_point){ft_strlen(g_tab[0]),sizeof(g_tab)/sizeof(g_tab[0])}))
		exit(100);
	env.player.look.x = 1;
	env.player.pos = (t_point){1,1};
	env.bonus = false;
	env.graphics.ceil_col = 0xFF;
	env.graphics.floor_col = 0xFF00;
	calculate_angles(WIDTH, env.angles, 90, 1);
	register_hooks(&env);
	mlx_loop(env.mlx);
}
